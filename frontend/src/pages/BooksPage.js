import React, { useState, useEffect, useContext } from "react";
//import MainLayout from "../layouts/MainLayout";
import { Link, useNavigate, useLocation } from "react-router-dom";
import { AuthContext } from "../AuthContext";
import "./BooksPage.css";
import "../App.css";

const BooksPage = () => {
  const { isAuthenticated } = useContext(AuthContext); // ‚úÖ –•—É–∫ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

  const location = useLocation();
  const [books, setBooks] = useState([]);
  const [selectedBook, setSelectedBook] = useState(null);
  const [currentPage, setCurrentPage] = useState(1);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [theme, setTheme] = useState(() => {
    const savedTheme = localStorage.getItem("theme");
    return savedTheme || "light";
  });
  //const [isAuthenticated, setIsAuthenticated] = useState(false);
  const navigate = useNavigate();

  useEffect(() => {
    document.body.setAttribute("data-theme", theme);
    localStorage.setItem("theme", theme);
  }, [theme]);

  const toggleTheme = () => {
    const themes = ["light", "dark", "nature", "ocean"];
    const currentIndex = themes.indexOf(theme);
    const nextIndex = (currentIndex + 1) % themes.length;
    const newTheme = themes[nextIndex];
    setTheme(newTheme);
  };

  useEffect(() => {
    // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü
    const testBooks = [
      {
        id: 1,
        title: "–¢–∞–π–Ω—ã –æ–∫–µ–∞–Ω–∞",
        author: "–ê–Ω–Ω–∞ –ú–æ—Ä—Å–∫–∞—è",
        cover_path:
          "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&auto=format&fit=crop&q=60",
        description: "–ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ –≥–ª—É–±–∏–Ω–∞—Ö –æ–∫–µ–∞–Ω–∞ –∏ –µ–≥–æ –æ–±–∏—Ç–∞—Ç–µ–ª—è—Ö",
      },
      {
        id: 2,
        title: "–ì–æ—Ä–æ–¥ –º–µ—á—Ç—ã",
        author: "–ú–∞–∫—Å–∏–º –ì–æ—Ä–æ–¥—Å–∫–æ–π",
        cover_path:
          "https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?w=800&auto=format&fit=crop&q=60",
        description: "–ò—Å—Ç–æ—Ä–∏—è –æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–µ–≥–∞–ø–æ–ª–∏—Å–µ –∏ –µ–≥–æ –∂–∏—Ç–µ–ª—è—Ö",
      },
      {
        id: 3,
        title: "–ó–≤—ë–∑–¥–Ω—ã–π –ø—É—Ç—å",
        author: "–ï–ª–µ–Ω–∞ –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è",
        cover_path:
          "https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?w=800&auto=format&fit=crop&q=60",
        description: "–§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –ø—Ä–æ—Å—Ç–æ—Ä–∞–º –∫–æ—Å–º–æ—Å–∞",
      },
      {
        id: 4,
        title: "–õ–µ—Å–Ω—ã–µ —Å–∫–∞–∑–∫–∏",
        author: "–ò–≤–∞–Ω –õ–µ—Å–Ω–æ–π",
        cover_path:
          "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&auto=format&fit=crop&q=60",
        description: "–í–æ–ª—à–µ–±–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ –∂–∏–∑–Ω–∏ –ª–µ—Å–Ω—ã—Ö –æ–±–∏—Ç–∞—Ç–µ–ª–µ–π",
      },
      {
        id: 5,
        title: "–ì–æ—Ä–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã",
        author: "–ê–ª–µ–∫—Å–µ–π –ê–ª—å–ø–∏–Ω–∏—Å—Ç",
        cover_path:
          "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=800&auto=format&fit=crop&q=60",
        description: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤ –º–∏—Ä–µ –≤—ã—Å–æ–∫–∏—Ö –≥–æ—Ä –∏ –∏—Ö —Ç–∞–π–Ω",
      },
      {
        id: 6,
        title: "–ü—É—Å—Ç—ã–Ω–Ω—ã–µ —Ç—Ä–æ–ø—ã",
        author: "–ú–∞—Ä–∏—è –°–∞—Ö–∞—Ä–∞",
        cover_path:
          "https://images.unsplash.com/photo-1509316785289-025f5b846b35?w=800&auto=format&fit=crop&q=60",
        description: "–ò—Å—Ç–æ—Ä–∏—è –æ –∂–∏–∑–Ω–∏ –≤ —Å–∞–º–æ–º –∂–∞—Ä–∫–æ–º –º–µ—Å—Ç–µ –Ω–∞ –ó–µ–º–ª–µ",
      },
      {
        id: 7,
        title: "–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏",
        author: "–ü—ë—Ç—Ä –°–µ–≤–µ—Ä–Ω—ã–π",
        cover_path:
          "https://images.unsplash.com/photo-1517299321609-52687d1bc55a?w=800&auto=format&fit=crop&q=60",
        description: "–†–∞—Å—Å–∫–∞–∑—ã –æ –∂–∏–∑–Ω–∏ –≤ —Ü–∞—Ä—Å—Ç–≤–µ –≤–µ—á–Ω–æ–π –º–µ—Ä–∑–ª–æ—Ç—ã",
      },
    ];
    const testPages = {
      1: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –ù–∞—á–∞–ª–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è\n\n–ì–ª—É–±–æ–∫–æ –≤ –æ–∫–µ–∞–Ω–µ, –≥–¥–µ —Å–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç –µ–¥–≤–∞ –ø—Ä–æ–Ω–∏–∫–∞–µ—Ç —Å–∫–≤–æ–∑—å —Ç–æ–ª—â—É –≤–æ–¥—ã, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è. –ó–¥–µ—Å—å, –≤ —Ü–∞—Ä—Å—Ç–≤–µ –≤–µ—á–Ω–æ–π —Ç–µ–º–Ω–æ—Ç—ã, –æ–±–∏—Ç–∞—é—Ç —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–∑–¥–∞–Ω–∏—è, –æ –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π –¥–∞–∂–µ –Ω–µ –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ—Ç.\n\n–ú–æ—Ä—Å–∫–∏–µ –≥–ª—É–±–∏–Ω—ã —Ö—Ä–∞–Ω—è—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∞–π–Ω, –∏ —Å–µ–≥–æ–¥–Ω—è –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º—Å—è –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –ù–∞—á–∞–ª–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–ü–µ—Ä–≤—ã–º —Å—É—â–µ—Å—Ç–≤–æ–º, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏, –±—ã–ª –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–π –∫–∞–ª—å–º–∞—Ä. –ï–≥–æ –æ–≥—Ä–æ–º–Ω—ã–µ –≥–ª–∞–∑–∞, —Ä–∞–∑–º–µ—Ä–æ–º —Å –±–∞—Å–∫–µ—Ç–±–æ–ª—å–Ω—ã–π –º—è—á, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∞–ª–∏ –Ω–∞—Å. –í —Ç–µ–º–Ω–æ—Ç–µ –æ–Ω–∏ —Å–≤–µ—Ç–∏–ª–∏—Å—å, –∫–∞–∫ –¥–≤–∞ —Ñ–æ–Ω–∞—Ä—è, –æ—Å–≤–µ—â–∞—è –ø—É—Ç—å –≤ –≥–ª—É–±–∏–Ω—ã –æ–∫–µ–∞–Ω–∞.\n\n–≠—Ç–æ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å –¥–ª–∏–Ω—ã –¥–æ 18 –º–µ—Ç—Ä–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –æ–¥–Ω–∏–º –∏–∑ —Å–∞–º—ã—Ö –∫—Ä—É–ø–Ω—ã—Ö –±–µ—Å–ø–æ–∑–≤–æ–Ω–æ—á–Ω—ã—Ö –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ.",
        },
        {
          page_number: 3,
          content:
            "–ì–ª–∞–≤–∞ 2: –¢–∞–π–Ω—ã –≥–ª—É–±–∏–Ω\n\n–ü–æ–≥—Ä—É–∂–∞—è—Å—å –≥–ª—É–±–∂–µ, –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —Ü–µ–ª—ã–π –≥–æ—Ä–æ–¥, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–∑ –∫–æ—Ä–∞–ª–ª–æ–≤. –ó–¥–µ—Å—å, –≤ –ø–æ–ª–Ω–æ–π —Ç–µ–º–Ω–æ—Ç–µ, –æ–±–∏—Ç–∞–ª–∏ —Ç—ã—Å—è—á–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∏–¥–æ–≤ —Ä—ã–± –∏ –¥—Ä—É–≥–∏—Ö –º–æ—Ä—Å–∫–∏—Ö —Å—É—â–µ—Å—Ç–≤.\n\n–ö–∞–∂–¥—ã–π —É–≥–æ–ª–æ–∫ —ç—Ç–æ–≥–æ –ø–æ–¥–≤–æ–¥–Ω–æ–≥–æ –º–µ–≥–∞–ø–æ–ª–∏—Å–∞ –±—ã–ª —É–Ω–∏–∫–∞–ª–µ–Ω –∏ –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω –ø–æ-—Å–≤–æ–µ–º—É. –Ø—Ä–∫–∏–µ –∫—Ä–∞—Å–∫–∏ –∫–æ—Ä–∞–ª–ª–æ–≤ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–µ –∑—Ä–µ–ª–∏—â–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞–º–∏.",
        },
      ],
      2: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞\n\n–†–∞–Ω–Ω–µ–µ —É—Ç—Ä–æ. –ü–µ—Ä–≤—ã–µ –ª—É—á–∏ —Å–æ–ª–Ω—Ü–∞ –∫–∞—Å–∞—é—Ç—Å—è –Ω–µ–±–æ—Å–∫—Ä—ë–±–æ–≤, –æ–∫—Ä–∞—à–∏–≤–∞—è –∏—Ö –≤ –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–µ —Ç–æ–Ω–∞. –ì–æ—Ä–æ–¥ –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è, –∏ –µ–≥–æ —É–ª–∏—Ü—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –Ω–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∂–∏–∑–Ω—å—é.\n\n–õ—é–¥–∏ —Å–ø–µ—à–∞—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É, –∫–∞—Ñ–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç —Å–≤–æ–∏ –¥–≤–µ—Ä–∏, –∞ —É–ª–∏—á–Ω—ã–µ –º—É–∑—ã–∫–∞–Ω—Ç—ã –Ω–∞—á–∏–Ω–∞—é—Ç —Å–≤–æ–π –¥–µ–Ω—å. –≠—Ç–æ –æ–±—ã—á–Ω–æ–µ —É—Ç—Ä–æ –≤ –±–æ–ª—å—à–æ–º –≥–æ—Ä–æ–¥–µ, –Ω–æ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–í —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞, –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –ø–ª–æ—â–∞–¥–∏, —É–∂–µ –∫–∏–ø–∏—Ç –∂–∏–∑–Ω—å. –£–ª–∏—á–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—Ü—ã —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞—é—Ç —Å–≤–æ–∏ —Ç–æ–≤–∞—Ä—ã, —Ç—É—Ä–∏—Å—Ç—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É—é—Ç –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ –º–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ —Å–ø–µ—à–∞—Ç –ø–æ —Å–≤–æ–∏–º –¥–µ–ª–∞–º.\n\n–ê—Ä–æ–º–∞—Ç —Å–≤–µ–∂–µ—Å–≤–∞—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ—Ñ–µ —Å–º–µ—à–∏–≤–∞–µ—Ç—Å—è —Å –∑–∞–ø–∞—Ö–æ–º –≤—ã–ø–µ—á–∫–∏ –∏–∑ –±–ª–∏–∂–∞–π—à–µ–π –ø–µ–∫–∞—Ä–Ω–∏. –≠—Ç–æ –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º—ã–π –∑–∞–ø–∞—Ö —É—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –≥–æ—Ä–æ–¥ –æ—Å–æ–±–µ–Ω–Ω—ã–º.",
        },
      ],
      3: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü–µ—Ä–≤—ã–π —à–∞–≥ –≤ –∫–æ—Å–º–æ—Å\n\n–ó–≤—ë–∑–¥—ã –º–µ—Ä—Ü–∞–ª–∏ –≤ –±–µ—Å–∫—Ä–∞–π–Ω–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∫–æ—Å–º–æ—Å–∞, –∫–∞–∫ –º–∏–ª–ª–∏–æ–Ω—ã –∫—Ä–æ—à–µ—á–Ω—ã—Ö –º–∞—è–∫–æ–≤, —É–∫–∞–∑—ã–≤–∞—é—â–∏—Ö –ø—É—Ç—å –∫ –Ω–µ–∏–∑–≤–µ–¥–∞–Ω–Ω—ã–º –º–∏—Ä–∞–º. –ù–∞—à –∫–æ—Ä–∞–±–ª—å, '–ó–≤—ë–∑–¥–Ω—ã–π —Å—Ç—Ä–∞–Ω–Ω–∏–∫', –≥–æ—Ç–æ–≤–∏–ª—Å—è –∫ —Å–≤–æ–µ–º—É –ø–µ—Ä–≤–æ–º—É –º–µ–∂–≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–æ–º—É –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—é.\n\n–≠–∫–∏–ø–∞–∂ –∏–∑ –ø—è—Ç–∏ —á–µ–ª–æ–≤–µ–∫ –ø—Ä–æ–≤–µ—Ä—è–ª –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º. –ö–∞–∂–¥—ã–π –ø–æ–Ω–∏–º–∞–ª –≤–∞–∂–Ω–æ—Å—Ç—å —ç—Ç–æ–π –º–∏—Å—Å–∏–∏ - –º—ã –±—ã–ª–∏ –ø–µ—Ä–≤—ã–º–∏, –∫—Ç–æ –æ—Ç–≤–∞–∂–∏–ª—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è —Ç–∞–∫ –¥–∞–ª–µ–∫–æ –æ—Ç –ó–µ–º–ª–∏.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü–µ—Ä–≤—ã–π —à–∞–≥ –≤ –∫–æ—Å–º–æ—Å (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–ö–æ–≥–¥–∞ –¥–≤–∏–≥–∞—Ç–µ–ª–∏ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ –ø–æ–ª–Ω—É—é –º–æ—â–Ω–æ—Å—Ç—å, –∫–æ—Ä–∞–±–ª—å –ø–ª–∞–≤–Ω–æ –æ—Ç–æ—Ä–≤–∞–ª—Å—è –æ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∫–æ—Å–º–æ–¥—Ä–æ–º–∞. –ß–µ—Ä–µ–∑ –∏–ª–ª—é–º–∏–Ω–∞—Ç–æ—Ä—ã –º—ã –Ω–∞–±–ª—é–¥–∞–ª–∏, –∫–∞–∫ –ó–µ–º–ª—è —Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –≤—Å—ë –º–µ–Ω—å—à–µ –∏ –º–µ–Ω—å—à–µ, –ø–æ–∫–∞ –Ω–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –∫—Ä–æ—à–µ—á–Ω—É—é –≥–æ–ª—É–±—É—é —Ç–æ—á–∫—É –≤ –±–µ—Å–∫—Ä–∞–π–Ω–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.\n\n–≠—Ç–æ –±—ã–ª –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏–∑–º–µ–Ω–∏–ª –Ω–∞—à—É –∂–∏–∑–Ω—å –Ω–∞–≤—Å–µ–≥–¥–∞. –ú—ã —Å—Ç–∞–ª–∏ –ø–µ—Ä–≤—ã–º–∏ –ª—é–¥—å–º–∏, –æ—Ç–ø—Ä–∞–≤–∏–≤—à–∏–º–∏—Å—è –∫ –∑–≤—ë–∑–¥–∞–º.",
        },
      ],
      4: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –õ–µ—Å–Ω–æ–µ —Ü–∞—Ä—Å—Ç–≤–æ\n\n–í —Å–∞–º–æ–º —Å–µ—Ä–¥—Ü–µ –¥—Ä–µ–≤–Ω–µ–≥–æ –ª–µ—Å–∞, –≥–¥–µ –¥–µ—Ä–µ–≤—å—è –¥–æ—Å—Ç–∏–≥–∞—é—Ç –Ω–µ–±–µ—Å, –∞ —Å–æ–ª–Ω–µ—á–Ω—ã–µ –ª—É—á–∏ –µ–¥–≤–∞ –ø—Ä–æ–±–∏–≤–∞—é—Ç—Å—è —Å–∫–≤–æ–∑—å –≥—É—Å—Ç—É—é –ª–∏—Å—Ç–≤—É, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è. –ó–¥–µ—Å—å, –≤ —ç—Ç–æ–º –≤–æ–ª—à–µ–±–Ω–æ–º —Ü–∞—Ä—Å—Ç–≤–µ, –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á—Ç–æ-—Ç–æ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ–µ.\n\n–°—Ç–∞—Ä—ã–π –¥—É–±, –∫–æ—Ç–æ—Ä—ã–π –º–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ –Ω–∞–∑—ã–≤–∞—é—Ç –•—Ä–∞–Ω–∏—Ç–µ–ª–µ–º –ª–µ—Å–∞, –≤–∏–¥–µ–ª –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—Ä–∏–π –∑–∞ —Å–≤–æ–∏ —Ç—ã—Å—è—á—É –ª–µ—Ç –∂–∏–∑–Ω–∏. –ò —Å–µ–≥–æ–¥–Ω—è –æ–Ω –≥–æ—Ç–æ–≤ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –Ω–∞–º–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –∏–∑ –Ω–∏—Ö.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –õ–µ—Å–Ω–æ–µ —Ü–∞—Ä—Å—Ç–≤–æ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–ü–µ—Ä–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ –¥—Ä—É–∂–±–µ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ –∑–∞–π—á–æ–Ω–∫–∞ –∏ –º—É–¥—Ä–æ–π —Å–æ–≤—ã. –ö–∞–∑–∞–ª–æ—Å—å –±—ã, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—â–µ–≥–æ —É —Ç–∞–∫–∏—Ö —Ä–∞–∑–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤? –ù–æ –∏–º–µ–Ω–Ω–æ –∏—Ö –Ω–µ–æ–±—ã—á–Ω–∞—è –¥—Ä—É–∂–±–∞ –ø–æ–º–æ–≥–ª–∞ —Å–ø–∞—Å—Ç–∏ –ª–µ—Å –æ—Ç –±–æ–ª—å—à–æ–π –±–µ–¥—ã.\n\n–°–æ–≤–∞, —Å –µ—ë –æ—Å—Ç—Ä—ã–º –∑—Ä–µ–Ω–∏–µ–º –∏ –º—É–¥—Ä–æ—Å—Ç—å—é, –∏ –∑–∞–π—á–æ–Ω–æ–∫, —Å –µ–≥–æ –±—ã—Å—Ç—Ä–æ—Ç–æ–π –∏ —Ö—Ä–∞–±—Ä–æ—Å—Ç—å—é, –≤–º–µ—Å—Ç–µ —Å–º–æ–≥–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –≤—Å–µ—Ö –ª–µ—Å–Ω—ã—Ö –∂–∏—Ç–µ–ª–µ–π –æ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–µ–π—Å—è –æ–ø–∞—Å–Ω–æ—Å—Ç–∏.",
        },
      ],
      5: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –í–µ—Ä—à–∏–Ω–∞ –º–∏—Ä–∞\n\n–í—ã—Å–æ–∫–æ –≤ –≥–æ—Ä–∞—Ö, –≥–¥–µ –≤–æ–∑–¥—É—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º, –∞ –æ–±–ª–∞–∫–∞ –ø–ª—ã–≤—É—Ç –Ω–∏–∂–µ –≤–µ—Ä—à–∏–Ω, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞—à–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ. –ó–¥–µ—Å—å, —Å—Ä–µ–¥–∏ –≤–µ—á–Ω—ã—Ö —Å–Ω–µ–≥–æ–≤ –∏ –æ—Å—Ç—Ä—ã—Ö —Å–∫–∞–ª, —á–µ–ª–æ–≤–µ–∫ —á—É–≤—Å—Ç–≤—É–µ—Ç —Å–µ–±—è –º–∞–ª–µ–Ω—å–∫–∏–º –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–∞—Å—Ç—å—é —á–µ–≥–æ-—Ç–æ –≤–µ–ª–∏–∫–æ–≥–æ.\n\n–ê–ª—å–ø–∏–Ω–∏—Å—Ç—ã –Ω–∞–∑—ã–≤–∞—é—Ç —ç—Ç–∏ –º–µ—Å—Ç–∞ '–∫—Ä—ã—à–µ–π –º–∏—Ä–∞'. –ò –Ω–µ –∑—Ä—è - –æ—Ç—Å—é–¥–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–∏–¥ –Ω–∞ –±–µ—Å–∫—Ä–∞–π–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å—Ç–∏—Ä–∞—é—Ç—Å—è –¥–æ —Å–∞–º–æ–≥–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –í–µ—Ä—à–∏–Ω–∞ –º–∏—Ä–∞ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–í–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ä—à–∏–Ω—É - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ. –≠—Ç–æ –ø—É—Ç—å –∫ —Å–∞–º–æ–º—É —Å–µ–±–µ, –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Å–≤–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –ø—Ä–µ–¥–µ–ª–æ–≤. –ö–∞–∂–¥—ã–π —à–∞–≥ –≤–≤–µ—Ä—Ö - —ç—Ç–æ –ø–æ–±–µ–¥–∞ –Ω–∞–¥ —Å—Ç—Ä–∞—Ö–æ–º –∏ —Å–æ–º–Ω–µ–Ω–∏—è–º–∏.\n\n–ù–∞ –≤—ã—Å–æ—Ç–µ 8000 –º–µ—Ç—Ä–æ–≤ –Ω–∞–¥ —É—Ä–æ–≤–Ω–µ–º –º–æ—Ä—è, –≥–¥–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –≤–æ–∑–¥—É—Ö–µ –≤ —Ç—Ä–∏ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ, —á–µ–º –≤–Ω–∏–∑—É, –∫–∞–∂–¥—ã–π –≤–¥–æ—Ö —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–º, –∞ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç - –æ—Å–æ–±–µ–Ω–Ω—ã–º.",
        },
      ],
      6: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü–µ—Å—á–∞–Ω–æ–µ –º–æ—Ä–µ\n\n–ü—É—Å—Ç—ã–Ω—è –°–∞—Ö–∞—Ä–∞ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–≥—Ä–æ–º–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–µ—Å–∫–∞. –≠—Ç–æ –∂–∏–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –¥—ã—à–∏—Ç, –º–µ–Ω—è–µ—Ç—Å—è –∏ —Ö—Ä–∞–Ω–∏—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∞–π–Ω. –î–Ω—ë–º –∑–¥–µ—Å—å –Ω–µ–≤—ã–Ω–æ—Å–∏–º–∞—è –∂–∞—Ä–∞, –∞ –Ω–æ—á—å—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –æ–ø—É—Å—Ç–∏—Ç—å—Å—è –Ω–∏–∂–µ –Ω—É–ª—è.\n\n–ù–æ –¥–∞–∂–µ –≤ —Ç–∞–∫–∏—Ö —Å—É—Ä–æ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∂–∏–∑–Ω—å. –í–µ—Ä–±–ª—é–¥—ã, —Å–∫–æ—Ä–ø–∏–æ–Ω—ã, –∑–º–µ–∏ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö —Å—É—â–µ—Å—Ç–≤ –ø—Ä–∏—Å–ø–æ—Å–æ–±–∏–ª–∏—Å—å –∫ –∂–∏–∑–Ω–∏ –≤ —ç—Ç–æ–º —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–º –∫–ª–∏–º–∞—Ç–µ.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –ü–µ—Å—á–∞–Ω–æ–µ –º–æ—Ä–µ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–û–∞–∑–∏—Å—ã –≤ –ø—É—Å—Ç—ã–Ω–µ - —ç—Ç–æ –∫–∞–∫ –æ—Å—Ç—Ä–æ–≤–∞ –∂–∏–∑–Ω–∏ –≤ –ø–µ—Å—á–∞–Ω–æ–º –º–æ—Ä–µ. –ó–¥–µ—Å—å, —Å—Ä–µ–¥–∏ –ø–∞–ª—å–º –∏ –ø—Ä–æ—Ö–ª–∞–¥–Ω–æ–π –≤–æ–¥—ã, –ø—É—Ç–Ω–∏–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç –ø—Ä–∏—é—Ç –∏ –æ—Ç–¥—ã—Ö. –ú–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ –Ω–∞—É—á–∏–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤–æ–¥—ã, –∫–∞–∂–¥–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ, –∫–∞–∂–¥–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ.\n\n–ò—Ö –º—É–¥—Ä–æ—Å—Ç—å, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –≤–µ–∫–∞–º–∏, –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã–∂–∏–≤–∞—Ç—å –≤ —ç—Ç–æ–º —Å—É—Ä–æ–≤–æ–º –∫—Ä–∞—é. –û–Ω–∏ –∑–Ω–∞—é—Ç, –∫–∞–∫ —á–∏—Ç–∞—Ç—å –∑–≤—ë–∑–¥—ã, –∫–∞–∫ –Ω–∞—Ö–æ–¥–∏—Ç—å –≤–æ–¥—É –ø–æ–¥ –ø–µ—Å–∫–æ–º, –∫–∞–∫ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–µ—Å—á–∞–Ω—ã–µ –±—É—Ä–∏.",
        },
      ],
      7: [
        {
          page_number: 1,
          content:
            "–ì–ª–∞–≤–∞ 1: –¶–∞—Ä—Å—Ç–≤–æ –ª—å–¥–∞\n\n–ê—Ä–∫—Ç–∏–∫–∞ - —ç—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –ø—Ä–∏—Ä–æ–¥–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–≤–æ—é —Å–∏–ª—É –∏ –∫—Ä–∞—Å–æ—Ç—É –≤ —Å–∞–º—ã—Ö —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö. –ó–¥–µ—Å—å –ø–æ–ª—è—Ä–Ω–∞—è –Ω–æ—á—å —Å–º–µ–Ω—è–µ—Ç—Å—è –ø–æ–ª—è—Ä–Ω—ã–º –¥–Ω—ë–º, –∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ–∂–µ—Ç –æ–ø—É—Å–∫–∞—Ç—å—Å—è –¥–æ -60 –≥—Ä–∞–¥—É—Å–æ–≤.\n\n–ù–æ –¥–∞–∂–µ –≤ —Ç–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö –∂–∏–∑–Ω—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –æ–Ω–∞ –ø—Ä–æ—Ü–≤–µ—Ç–∞–µ—Ç. –ë–µ–ª—ã–µ –º–µ–¥–≤–µ–¥–∏, —Ç—é–ª–µ–Ω–∏, –º–æ—Ä–∂–∏ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö —Å–æ–∑–¥–∞–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω—É—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å —Å—É—Ä–æ–≤—ã–º –∫–ª–∏–º–∞—Ç–æ–º.",
        },
        {
          page_number: 2,
          content:
            "–ì–ª–∞–≤–∞ 1: –¶–∞—Ä—Å—Ç–≤–æ –ª—å–¥–∞ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)\n\n–°–µ–≤–µ—Ä–Ω–æ–µ —Å–∏—è–Ω–∏–µ - –æ–¥–Ω–æ –∏–∑ —Å–∞–º—ã—Ö —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —è–≤–ª–µ–Ω–∏–π –ø—Ä–∏—Ä–æ–¥—ã. –ó–µ–ª—ë–Ω—ã–µ, —Å–∏–Ω–∏–µ –∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ –ª—É—á–∏ —Ç–∞–Ω—Ü—É—é—Ç –≤ –Ω–µ–±–µ, —Å–æ–∑–¥–∞–≤–∞—è –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–µ –∑—Ä–µ–ª–∏—â–µ. –ú–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ –≤–µ—Ä—è—Ç, —á—Ç–æ —ç—Ç–æ –¥—É—Ö–∏ –ø—Ä–µ–¥–∫–æ–≤ –∏–≥—Ä–∞—é—Ç –≤ –Ω–µ–±–µ—Å–Ω–æ–º —à–∞—Ä–µ.\n\n–ñ–∏–∑–Ω—å –≤ –ê—Ä–∫—Ç–∏–∫–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–π –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ –∏ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª—è–µ–º–æ—Å—Ç–∏. –õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–¥–µ—Å—å –∂–∏–≤—É—Ç, –Ω–∞—É—á–∏–ª–∏—Å—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤—ã–∂–∏–≤–∞—Ç—å, –Ω–æ –∏ –ø—Ä–æ—Ü–≤–µ—Ç–∞—Ç—å –≤ —ç—Ç–∏—Ö —Å—É—Ä–æ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.",
        },
      ],
    };
    setBooks(testBooks);
    setLoading(false);
    window.testPages = testPages;
  }, []);

  const fetchBookPages = async (bookId) => {
    return window.testPages[bookId] || [];
  };

  const handleBookClick = async (book) => {
    const pages = await fetchBookPages(book.id);
    setSelectedBook({ ...book, pages });
    setCurrentPage(1);
  };

  const handleCloseReader = () => {
    setSelectedBook(null);
    setCurrentPage(1);
  };

  const handleNextPage = () => {
    if (currentPage < selectedBook.pages.length) {
      setCurrentPage(currentPage + 1);
    }
  };

  const handlePrevPage = () => {
    if (currentPage > 1) {
      setCurrentPage(currentPage - 1);
    }
  };

  const handleProfileClick = () => {
    if (isAuthenticated) {
      navigate("/profile");
    } else {
      navigate("/login");
    }
  };

  const handleMyBooksClick = () => {
    navigate("/my-books");
  };

  const handleLoginClick = () => {
    navigate("/login");
  };

  if (loading) {
    return <div className="books-page">Loading...</div>;
  }

  if (error) {
    return <div className="books-page">{error}</div>;
  }

  return (
    <div className="books-page">
      <header className="books-header">
        <Link to="/" className="logo">
          BookAndBooks
        </Link>
        <div className="header-buttons">
          <button className="profile-button" onClick={handleProfileClick}>
            üë§
          </button>
          {isAuthenticated ? (
            <button onClick={handleMyBooksClick}>–ú–æ–∏ –∫–Ω–∏–≥–∏</button>
          ) : (
            <button onClick={handleLoginClick}>–í–æ–π—Ç–∏</button>
          )}
        </div>
      </header>

      <div className="theme-switcher">
        <button onClick={toggleTheme} className="theme-button">
          {theme === "light" && "üåû"}
          {theme === "dark" && "üåô"}
          {theme === "nature" && "üåø"}
          {theme === "ocean" && "üåä"}
        </button>
      </div>

      <h1>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</h1>
      <div className="books-grid">
        {books.map((book) => (
          <div
            key={book.id}
            className="book-card"
            onClick={() => handleBookClick(book)}
          >
            <img
              src={book.cover_path}
              alt={book.title}
              className="book-cover"
            />
            <div className="book-info">
              <h2 className="book-title">{book.title}</h2>
              <p className="book-author">–ê–≤—Ç–æ—Ä: {book.author}</p>
              <p className="book-description">{book.description}</p>
            </div>
          </div>
        ))}
      </div>

      {selectedBook && (
        <div className="book-reader-modal">
          <div className="book-reader-content">
            <button className="close-button" onClick={handleCloseReader}>
              √ó
            </button>
            <h2>{selectedBook.title}</h2>
            <p className="book-author">–ê–≤—Ç–æ—Ä: {selectedBook.author}</p>
            <div className="book-text">
              {selectedBook.pages[currentPage - 1]?.content}
            </div>
            <div className="page-navigation">
              <button
                className="page-button"
                onClick={handlePrevPage}
                disabled={currentPage === 1}
              >
                –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
              </button>
              <span className="page-number">
                –°—Ç—Ä–∞–Ω–∏—Ü–∞ {currentPage} –∏–∑ {selectedBook.pages.length}
              </span>
              <button
                className="page-button"
                onClick={handleNextPage}
                disabled={currentPage === selectedBook.pages.length}
              >
                –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default BooksPage;
